<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Calendar</title>
    <style>
        .calendar {
            width: 90%;
            table-layout: fixed;
            border-collapse: collapse;
            margin: auto;
        }
        .calendar th,
        .calendar td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: left;
            font-size: 14px;
            background-color:green
        }
        .calendar th {
            background-color: #f2f2f2;
        }
        .unselectable {
            user-select: none;
        }
        body {
            touch-action: none !important;
        }
    </style>
<script>
    document.documentElement.requestFullscreen()
    var selected_times = []
    var column = 0
    var adding = true
    var isDown = false;   // Tracks status of mouse button
    document.addEventListener("mousedown",()=>{
        document.getElementById("down").innerHTML = "down"
        isDown = true})
    document.addEventListener("touchstart",()=>{
        document.getElementById("down").innerHTML = "down"
        isDown = true})
    document.addEventListener("mouseup",()=>{
        document.getElementById("down").innerHTML = "up"
        isDown = false})
    document.addEventListener("touchmove",(e)=>{
        e.preventDefault()
        if (isDown){
            const cx = e.touches[0].clientX
            const cy = e.touches[0].clientY
            const elem = document.elementFromPoint(cx,cy)
            document.getElementById("selected").innerHTML = elem.innerHTML
            colorChange(elem)
        }
    },true)
    document.addEventListener("touchend",()=>{
        document.getElementById("down").innerHTML = "up"
        isDown = false})
</script>
</head>
<body style="touch-action: none !important;">
    <h1>Weekly Calendar</h1>
    <table class="calendar unselectable">
        <thead>
            <tr>
                <th>Mon</th>
                <th>Tues</th>
                <th>Wed</th>
                <th>Thurs</th>
                <th>Fri</th>
                <th>Sat</th>
                <th>Sun</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td  
                onclick="day_tracker(this)"
                onmouseover="colorChange(this)"
                class="start_timing unselectable" 
                id = "7_1">
                8 AM - 9 AM
                </td>
            </tr>
            <tr>
                <td 
                onclick="day_tracker(this)"
                onmouseover="colorChange(this)"
                class="start_timing unselectable" 
                id = "7_2">
                9:00 AM - 10:00 AM
                </td>
            </tr>
            <tr><td class="start_timing">10:00 AM</td></tr>
            <tr><td>11:00 AM</td></tr>
            <tr><td>12:00 AM</td></tr>
            <tr><td>1:00 PM</td></tr>
            <tr><td>2:00 PM</td></tr>
            <tr><td>3:00 PM</td></tr>
            <tr></tr>
            <tr></tr>
                
                
            <!-- Add more rows for different times -->
        </tbody>
    </table>
    <div id = val>test</div>
<div id = selected style = "color: red">test3</div>
<div id = down style = "color:red">test2</div>
<div id = day>day</div>
</body>

<script>
function multiplyNode(node_list, count, deep) {
    for (const elem of node_list){
        const day_time = elem.id.toString().split("_")
        const day_num = Number(day_time[0])
        const time_num = day_time[1]
        for (var i = 1, copy; i < count; i++) {
            const copy = elem.cloneNode(deep);
            const new_id = `${i}_${time_num}`
            copy.id = new_id
            elem.parentNode.insertBefore(copy, elem);
        }}
    
}
multiplyNode(document.querySelectorAll('.start_timing'), 7, true);

function day_tracker(elem){
    const day_time = elem.id.toString().split("_")
    const day = Number(day_time[0])
    const time_num = Number(day_time[1])
    column = day
    document.getElementById("day").innerHTML = day
    if (elem.style.backgroundColor == "blue"){
        adding = false
        elem.style.backgroundColor = "green"
        const index = selected_times.indexOf(day*time_num)
        selected_times.splice(index,1)
    } else {
        adding = true
        elem.style.backgroundColor = "blue"
        selected_times.push(day*time_num)
    }
}

function colorChange(elem){
    const day_time = elem.id.toString().split("_")
    const day = Number(day_time[0])
    const time_num = Number(day_time[1])
    if (isDown & day == column){
        if (elem.style.backgroundColor == "blue" && adding == false){
            elem.style.backgroundColor = "green"
            const index = selected_times.indexOf(day*time_num)
            selected_times.splice(index,1)
        } else if (elem.style.backgroundColor != "blue" && adding == true){
            elem.style.backgroundColor = "blue"
            selected_times.push(day*time_num)
        }
        document.getElementById("val").innerHTML = selected_times.toString()
    }
}

function day_tracker_touch(){}
</script>
</html>
